/*! angular-powerbi v1.0.0-beta.4 | (c) 2016 Microsoft Corporation MIT */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("powerbi-client")):"function"==typeof define&&define.amd?define(["powerbi-client"],t):"object"==typeof exports?exports["angular-powerbi"]=t(require("powerbi-client")):e["angular-powerbi"]=t(e["powerbi-client"])}(this,function(e){return function(e){function t(i){if(o[i])return o[i].exports;var r=o[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";var i=o(1),r=o(2),n=o(3);t.service=n["default"],t.components={report:i["default"],component:r["default"]},angular.module("powerbi.global",[]).value("PowerBiGlobal",window["powerbi-client"].service.Service),angular.module("powerbi.service",["powerbi.global"]).service("PowerBiService",n["default"]),angular.module("powerbi.components.powerbiReport",["powerbi.service"]).directive("powerbiReport",function(){return new i["default"]}),angular.module("powerbi.components.powerbiComponent",["powerbi.service"]).directive("powerbiComponent",function(){return new r["default"]}),angular.module("powerbi.components",["powerbi.components.powerbiReport","powerbi.components.powerbiComponent"]),angular.module("powerbi",["powerbi.service","powerbi.components"])},function(e,t){"use strict";var o=function(){function e(e,t,o){this.$scope=e,this.$timeout=t,this.powerBiService=o}return e.prototype.init=function(e){var t=this;this.validateRequiredAttributes()&&this.embed(e);var o=this.debounce(function(){t.validateRequiredAttributes()?t.embed(e):t.component&&t.reset(e)},100);this.$scope.$watch(function(){return t.embedUrl},function(t,i){t!==i&&o(e)}),this.$scope.$watch(function(){return t.accessToken},function(t,i){t!==i&&o(e)})},e.prototype.embed=function(e){var t={type:"report",embedUrl:this.embedUrl,accessToken:this.accessToken,id:this.reportId,uniqueId:this.name};angular.extend(t,this.options),this.component=this.powerBiService.embed(e,t)},e.prototype.reset=function(e){this.powerBiService.reset(e),this.component=null},e.prototype.debounce=function(e,t){var o,i=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];o&&i.$timeout.cancel(o),o=i.$timeout(function(){return e.apply(void 0,r)},t)}},e.prototype.validateRequiredAttributes=function(){return"string"==typeof this.embedUrl&&this.embedUrl.length>0&&"string"==typeof this.accessToken&&this.accessToken.length>0},e.$inject=["$scope","$timeout","PowerBiService"],e}();t.Controller=o;var i=function(){function e(){this.restrict="E",this.replace=!0,this.template='<div class="powerbi-frame"></div>',this.scope={accessToken:"=",embedUrl:"=",reportId:"=?",name:"=?",options:"=?"},this.controller=o,this.bindToController=!0,this.controllerAs="vm"}return e.prototype.link=function(e,t,o,i,r){i.init(t[0]),e.$on("$destroy",function(){i.reset(t[0])})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t){"use strict";var o=function(){function e(e,t){this.$scope=e,this.powerBiService=t,this.validationMap={report:this.validateReportOptions}}return e.prototype.init=function(e){var t=this;this.validateOptions(this.options)&&this.embed(e,this.options),this.$scope.$watch(function(){return t.options},function(o,i){o!==i&&(t.validateOptions(t.options)?t.embed(e,t.options):t.component&&t.reset(e))},!0)},e.prototype.embed=function(e,t){this.component=this.powerBiService.embed(e,t)},e.prototype.reset=function(e){this.powerBiService.reset(e),this.component=null},e.prototype.validateOptions=function(e){return this.options&&"string"==typeof e.embedUrl&&e.embedUrl.length>0&&"string"==typeof e.accessToken&&e.accessToken.length>0&&this.validationMap.hasOwnProperty(e.type)&&"function"==typeof this.validationMap[e.type]?this.validationMap[e.type](e):!1},e.prototype.validateReportOptions=function(e){return!0},e.$inject=["$scope","PowerBiService"],e}();t.Controller=o;var i=function(){function e(){this.restrict="E",this.replace=!0,this.template='<div class="powerbi-frame"></div>',this.scope={accessToken:"=",embedUrl:"=",options:"=?"},this.controller=o,this.bindToController=!0,this.controllerAs="vm"}return e.prototype.link=function(e,t,o,i,r){i.init(t[0]),e.$on("$destroy",function(){i.reset(t[0])})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t,o){"use strict";var i=o(4),r=function(){function e(e){this.powerBiCoreService=new e(i.factories.hpmFactory,i.factories.wpmpFactory,i.factories.routerFactory)}return e.prototype.embed=function(e,t){return this.powerBiCoreService.embed(e,t)},e.prototype.reset=function(e){this.powerBiCoreService.reset(e)},e.$inject=["PowerBiGlobal"],e}();Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(t,o){t.exports=e}])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItcG93ZXJiaS5qcyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJyZXF1aXJlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNF9fIiwibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJjb21wb25lbnRfMSIsImNvbXBvbmVudF8yIiwicG93ZXJiaV8xIiwic2VydmljZSIsImNvbXBvbmVudHMiLCJyZXBvcnQiLCJjb21wb25lbnQiLCJhbmd1bGFyIiwidmFsdWUiLCJ3aW5kb3ciLCJTZXJ2aWNlIiwiZGlyZWN0aXZlIiwiQ29udHJvbGxlciIsIiRzY29wZSIsIiR0aW1lb3V0IiwicG93ZXJCaVNlcnZpY2UiLCJwcm90b3R5cGUiLCJpbml0IiwiZWxlbWVudCIsIl90aGlzIiwidmFsaWRhdGVSZXF1aXJlZEF0dHJpYnV0ZXMiLCJlbWJlZCIsImRlYm91bmNlZEVtYmVkIiwiZGVib3VuY2UiLCJyZXNldCIsIiR3YXRjaCIsImVtYmVkVXJsIiwib2xkRW1iZWRVcmwiLCJhY2Nlc3NUb2tlbiIsIm9sZEFjY2Vzc1Rva2VuIiwiY29uZmlnIiwidHlwZSIsInJlcG9ydElkIiwidW5pcXVlSWQiLCJuYW1lIiwiZXh0ZW5kIiwib3B0aW9ucyIsImZ1bmMiLCJ3YWl0IiwicHJldmlvdXNUaW1lb3V0UHJvbWlzZSIsImFyZ3MiLCJfaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsImNhbmNlbCIsImFwcGx5IiwiJGluamVjdCIsIkRpcmVjdGl2ZSIsInJlc3RyaWN0IiwicmVwbGFjZSIsInRlbXBsYXRlIiwic2NvcGUiLCJjb250cm9sbGVyIiwiYmluZFRvQ29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsImxpbmsiLCJhdHRyaWJ1dGVzIiwidHJhbnNjbHVkZUZuIiwiJG9uIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWxpZGF0aW9uTWFwIiwidmFsaWRhdGVSZXBvcnRPcHRpb25zIiwidmFsaWRhdGVPcHRpb25zIiwib2xkT3B0aW9ucyIsImhhc093blByb3BlcnR5IiwicGJpIiwiUG93ZXJCaVNlcnZpY2UiLCJQb3dlckJpIiwicG93ZXJCaUNvcmVTZXJ2aWNlIiwiZmFjdG9yaWVzIiwiaHBtRmFjdG9yeSIsIndwbXBGYWN0b3J5Iiwicm91dGVyRmFjdG9yeSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBMkNBLEVBQU1DLEdBQzFCLGdCQUFaQyxVQUEwQyxnQkFBWEMsUUFDeENBLE9BQU9ELFFBQVVELEVBQVFHLFFBQVEsbUJBQ1Isa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUM5Q0QsUUFBUSxrQkFBbUJKLEdBQ0QsZ0JBQVpDLFNBQ2RBLFFBQVEsbUJBQXFCRCxFQUFRRyxRQUFRLG1CQUU3Q0osRUFBSyxtQkFBcUJDLEVBQVFELEVBQUssb0JBQ3RDTyxLQUFNLFNBQVNDLEdBQ2xCLE1BQWdCLFVBQVVDLEdBS2hCLFFBQVNDLEdBQW9CQyxHQUc1QixHQUFHQyxFQUFpQkQsR0FDbkIsTUFBT0MsR0FBaUJELEdBQVVULE9BR25DLElBQUlDLEdBQVNTLEVBQWlCRCxJQUM3QlQsV0FDQVcsR0FBSUYsRUFDSkcsUUFBUSxFQVVULE9BTkFMLEdBQVFFLEdBQVVJLEtBQUtaLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNRLEdBRy9EUCxFQUFPVyxRQUFTLEVBR1RYLEVBQU9ELFFBdkJmLEdBQUlVLEtBcUNKLE9BVEFGLEdBQW9CTSxFQUFJUCxFQUd4QkMsRUFBb0JPLEVBQUlMLEVBR3hCRixFQUFvQlEsRUFBSSxHQUdqQlIsRUFBb0IsS0FLL0IsU0FBU1AsRUFBUUQsRUFBU1EsR0FFL0IsWUFDQSxJQUFJUyxHQUFjVCxFQUFvQixHQUNsQ1UsRUFBY1YsRUFBb0IsR0FDbENXLEVBQVlYLEVBQW9CLEVBQ3BDUixHQUFRb0IsUUFBVUQsRUFBQUEsV0FDbEJuQixF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SCxFQUFTWSxJQUVsRHFDLEVBQWVuRCxVQUFVUSxNQUFRLFNBQVVOLEdBQ3ZDOUIsS0FBS2lGLG1CQUFtQjdDLE1BQU1OLElBRWxDaUQsRUFBZXJCLFNBQ1gsaUJBRUdxQixJQUVYUixRQUFPQyxlQUFlN0UsRUFBUyxjQUFnQnlCLE9BQU8sSUFDdER6QixFQUFBQSxXQUFrQm9GLEdBS2IsU0FBU25GLEVBQVFELEdBRXRCQyxFQUFPRCxRQUFVTSIsImZpbGUiOiJhbmd1bGFyLXBvd2VyYmkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJwb3dlcmJpLWNsaWVudFwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJwb3dlcmJpLWNsaWVudFwiXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJhbmd1bGFyLXBvd2VyYmlcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJwb3dlcmJpLWNsaWVudFwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiYW5ndWxhci1wb3dlcmJpXCJdID0gZmFjdG9yeShyb290W1wicG93ZXJiaS1jbGllbnRcIl0pO1xufSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV80X18pIHtcbnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBjb21wb25lbnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XHJcblx0dmFyIGNvbXBvbmVudF8yID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgcG93ZXJiaV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcclxuXHRleHBvcnRzLnNlcnZpY2UgPSBwb3dlcmJpXzEuZGVmYXVsdDtcclxuXHRleHBvcnRzLmNvbXBvbmVudHMgPSB7XHJcblx0ICAgIHJlcG9ydDogY29tcG9uZW50XzEuZGVmYXVsdCxcclxuXHQgICAgY29tcG9uZW50OiBjb21wb25lbnRfMi5kZWZhdWx0XHJcblx0fTtcclxuXHRhbmd1bGFyLm1vZHVsZSgncG93ZXJiaS5nbG9iYWwnLCBbXSlcclxuXHQgICAgLnZhbHVlKCdQb3dlckJpR2xvYmFsJywgd2luZG93Wydwb3dlcmJpLWNsaWVudCddLnNlcnZpY2UuU2VydmljZSk7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3Bvd2VyYmkuc2VydmljZScsIFtcclxuXHQgICAgJ3Bvd2VyYmkuZ2xvYmFsJ1xyXG5cdF0pXHJcblx0ICAgIC5zZXJ2aWNlKCdQb3dlckJpU2VydmljZScgLyogc2VydmljZS5uYW1lICovLCBwb3dlcmJpXzEuZGVmYXVsdCk7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3Bvd2VyYmkuY29tcG9uZW50cy5wb3dlcmJpUmVwb3J0JywgW1xyXG5cdCAgICAncG93ZXJiaS5zZXJ2aWNlJ1xyXG5cdF0pXHJcblx0ICAgIC5kaXJlY3RpdmUoJ3Bvd2VyYmlSZXBvcnQnIC8qIHJlcG9ydERpcmVjdGl2ZS5uYW1lICovLCBmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgY29tcG9uZW50XzEuZGVmYXVsdCgpOyB9KTtcclxuXHRhbmd1bGFyLm1vZHVsZSgncG93ZXJiaS5jb21wb25lbnRzLnBvd2VyYmlDb21wb25lbnQnLCBbXHJcblx0ICAgICdwb3dlcmJpLnNlcnZpY2UnXHJcblx0XSlcclxuXHQgICAgLmRpcmVjdGl2ZSgncG93ZXJiaUNvbXBvbmVudCcgLyogY29tcG9uZW50RGlyZWN0aXZlLm5hbWUgKi8sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBjb21wb25lbnRfMi5kZWZhdWx0KCk7IH0pO1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdwb3dlcmJpLmNvbXBvbmVudHMnLCBbXHJcblx0ICAgICdwb3dlcmJpLmNvbXBvbmVudHMucG93ZXJiaVJlcG9ydCcsXHJcblx0ICAgICdwb3dlcmJpLmNvbXBvbmVudHMucG93ZXJiaUNvbXBvbmVudCdcclxuXHRdKTtcclxuXHRhbmd1bGFyLm1vZHVsZSgncG93ZXJiaScsIFtcclxuXHQgICAgJ3Bvd2VyYmkuc2VydmljZScsXHJcblx0ICAgICdwb3dlcmJpLmNvbXBvbmVudHMnXHJcblx0XSk7XHJcblxuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIENvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBDb250cm9sbGVyKCRzY29wZSwgJHRpbWVvdXQsIHBvd2VyQmlTZXJ2aWNlKSB7XHJcblx0ICAgICAgICB0aGlzLiRzY29wZSA9ICRzY29wZTtcclxuXHQgICAgICAgIHRoaXMuJHRpbWVvdXQgPSAkdGltZW91dDtcclxuXHQgICAgICAgIHRoaXMucG93ZXJCaVNlcnZpY2UgPSBwb3dlckJpU2VydmljZTtcclxuXHQgICAgfVxyXG5cdCAgICAvKipcclxuXHQgICAgICogSGFuZGxlciBhZnRlciBjb21wb25lbnQgaXMgaW5zZXJ0ZWQgaW4gdGhlIERPTS4gSWYgcmVxdWlyZWQgYXR0cmlidXRlcyBhcmUgdmFsaWQgZW1iZWQgaW1tZWRpYXRlbHlcclxuXHQgICAgICogb3RoZXJ3aXNlLCB3YXRjaCBhdHRyaWJ1dGVzIGFuZCBlbWJlZCB3aGVuIHRoZXkgYXJlIHZhbGlkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgQ29udHJvbGxlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVSZXF1aXJlZEF0dHJpYnV0ZXMoKSkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuZW1iZWQoZWxlbWVudCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICAvLyBUT0RPOiBMb29rIGZvciBhbm90aGVyIHdheSB0byBlbnN1cmUgYm90aCBhdHRyaWJ1dGVzIGhhdmUgY2hhbmdlZCBiZWZvcmUgY2FsbGluZyB0aGlzLmVtYmVkLlxyXG5cdCAgICAgICAgLy8gSW4gbW9zdCBjYXNlcyBlbWJlZFVybCBhbmQgYWNjZXNzVG9rZW4gd2lsbCBiZSB1cGRhdGVkIGF0IHRoZSBzYW1lIHRpbWUsIGJ1dCB0aGlzIHRha2VzIHR3byBjeWNsZXNcclxuXHQgICAgICAgIC8vIGZvciB0aGUgY2hhbmdlcyB0byBwcm9wZWdhdGUgZnJvbSB0aGUgcGFyZW50ICRzY29wZSB0byB0aGlzICRzY29wZS5cclxuXHQgICAgICAgIC8vIHBlcmhhcHMgd2UgY2FuIGp1c3QgdXNlICR0aW1lb3V0KCkgZGlyZWN0bHkuIFxyXG5cdCAgICAgICAgdmFyIGRlYm91bmNlZEVtYmVkID0gdGhpcy5kZWJvdW5jZShmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgaWYgKF90aGlzLnZhbGlkYXRlUmVxdWlyZWRBdHRyaWJ1dGVzKCkpIHtcclxuXHQgICAgICAgICAgICAgICAgX3RoaXMuZW1iZWQoZWxlbWVudCk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2UgaWYgKF90aGlzLmNvbXBvbmVudCkge1xyXG5cdCAgICAgICAgICAgICAgICBfdGhpcy5yZXNldChlbGVtZW50KTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9LCAxMDApO1xyXG5cdCAgICAgICAgdGhpcy4kc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmVtYmVkVXJsOyB9LCBmdW5jdGlvbiAoZW1iZWRVcmwsIG9sZEVtYmVkVXJsKSB7XHJcblx0ICAgICAgICAgICAgLy8gR3VhcmQgYWdhaW5zdCBpbml0aWFsaXphdGlvblxyXG5cdCAgICAgICAgICAgIGlmIChlbWJlZFVybCA9PT0gb2xkRW1iZWRVcmwpIHtcclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBkZWJvdW5jZWRFbWJlZChlbGVtZW50KTtcclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICAgICAgdGhpcy4kc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmFjY2Vzc1Rva2VuOyB9LCBmdW5jdGlvbiAoYWNjZXNzVG9rZW4sIG9sZEFjY2Vzc1Rva2VuKSB7XHJcblx0ICAgICAgICAgICAgLy8gR3VhcmQgYWdhaW5zdCBpbml0aWFsaXphdGlvblxyXG5cdCAgICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbiA9PT0gb2xkQWNjZXNzVG9rZW4pIHtcclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBkZWJvdW5jZWRFbWJlZChlbGVtZW50KTtcclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogR2l2ZW4gYW4gSFRNTEVsZW1lbnQsIGNvbnN0cnVjdCBhbiBlbWJlZCBjb25maWd1cmF0aW9uIGJhc2VkIG9uIGF0dHJpYnV0ZXMgYW5kIHBhc3MgdG8gc2VydmljZS5cclxuXHQgICAgICovXHJcblx0ICAgIENvbnRyb2xsZXIucHJvdG90eXBlLmVtYmVkID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHQgICAgICAgIHZhciBjb25maWcgPSB7XHJcblx0ICAgICAgICAgICAgdHlwZTogJ3JlcG9ydCcsXHJcblx0ICAgICAgICAgICAgZW1iZWRVcmw6IHRoaXMuZW1iZWRVcmwsXHJcblx0ICAgICAgICAgICAgYWNjZXNzVG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXHJcblx0ICAgICAgICAgICAgaWQ6IHRoaXMucmVwb3J0SWQsXHJcblx0ICAgICAgICAgICAgdW5pcXVlSWQ6IHRoaXMubmFtZVxyXG5cdCAgICAgICAgfTtcclxuXHQgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGNvbmZpZywgdGhpcy5vcHRpb25zKTtcclxuXHQgICAgICAgIHRoaXMuY29tcG9uZW50ID0gdGhpcy5wb3dlckJpU2VydmljZS5lbWJlZChlbGVtZW50LCBjb25maWcpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogSGFuZGxlciB3aGVuIGNvbXBvbmVudCBpcyByZW1vdmVkIGZyb20gRE9NLiBGb3J3YXJkcyBjYWxsIHRvIHNlcnZpY2UgdG8gcGVyZm9ybSBjbGVhbnVwIG9mIHJlZmVyZW5jZXMgYmVmb3JlIERPTSBpcyBtb2RpZmllZC5cclxuXHQgICAgICovXHJcblx0ICAgIENvbnRyb2xsZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHQgICAgICAgIHRoaXMucG93ZXJCaVNlcnZpY2UucmVzZXQoZWxlbWVudCk7XHJcblx0ICAgICAgICB0aGlzLmNvbXBvbmVudCA9IG51bGw7XHJcblx0ICAgIH07XHJcblx0ICAgIENvbnRyb2xsZXIucHJvdG90eXBlLmRlYm91bmNlID0gZnVuY3Rpb24gKGZ1bmMsIHdhaXQpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICB2YXIgcHJldmlvdXNUaW1lb3V0UHJvbWlzZTtcclxuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuXHQgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG5cdCAgICAgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBpZiAocHJldmlvdXNUaW1lb3V0UHJvbWlzZSkge1xyXG5cdCAgICAgICAgICAgICAgICBfdGhpcy4kdGltZW91dC5jYW5jZWwocHJldmlvdXNUaW1lb3V0UHJvbWlzZSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIHByZXZpb3VzVGltZW91dFByb21pc2UgPSBfdGhpcy4kdGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBmdW5jLmFwcGx5KHZvaWQgMCwgYXJncyk7IH0sIHdhaXQpO1xyXG5cdCAgICAgICAgfTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEVuc3VyZSByZXF1aXJlZCBhdHRyaWJ1dGVzIChlbWJlZFVybCBhbmQgYWNjZXNzVG9rZW4gYXJlIHZhbGlkIGJlZm9yZSBhdHRlbXB0aW5nIHRvIGVtYmVkKVxyXG5cdCAgICAgKi9cclxuXHQgICAgQ29udHJvbGxlci5wcm90b3R5cGUudmFsaWRhdGVSZXF1aXJlZEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICByZXR1cm4gKHR5cGVvZiB0aGlzLmVtYmVkVXJsID09PSAnc3RyaW5nJyAmJiB0aGlzLmVtYmVkVXJsLmxlbmd0aCA+IDApXHJcblx0ICAgICAgICAgICAgJiYgKHR5cGVvZiB0aGlzLmFjY2Vzc1Rva2VuID09PSAnc3RyaW5nJyAmJiB0aGlzLmFjY2Vzc1Rva2VuLmxlbmd0aCA+IDApO1xyXG5cdCAgICB9O1xyXG5cdCAgICBDb250cm9sbGVyLiRpbmplY3QgPSBbXHJcblx0ICAgICAgICAnJHNjb3BlJyxcclxuXHQgICAgICAgICckdGltZW91dCcsXHJcblx0ICAgICAgICAnUG93ZXJCaVNlcnZpY2UnXHJcblx0ICAgIF07XHJcblx0ICAgIHJldHVybiBDb250cm9sbGVyO1xyXG5cdH0oKSk7XHJcblx0ZXhwb3J0cy5Db250cm9sbGVyID0gQ29udHJvbGxlcjtcclxuXHR2YXIgRGlyZWN0aXZlID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gRGlyZWN0aXZlKCkge1xyXG5cdCAgICAgICAgLy8gc3RhdGljIG5hbWUgPSBcInBvd2VyYmlSZXBvcnRcIjtcclxuXHQgICAgICAgIHRoaXMucmVzdHJpY3QgPSBcIkVcIjtcclxuXHQgICAgICAgIHRoaXMucmVwbGFjZSA9IHRydWU7XHJcblx0ICAgICAgICB0aGlzLnRlbXBsYXRlID0gJzxkaXYgY2xhc3M9XCJwb3dlcmJpLWZyYW1lXCI+PC9kaXY+JztcclxuXHQgICAgICAgIHRoaXMuc2NvcGUgPSB7XHJcblx0ICAgICAgICAgICAgYWNjZXNzVG9rZW46IFwiPVwiLFxyXG5cdCAgICAgICAgICAgIGVtYmVkVXJsOiBcIj1cIixcclxuXHQgICAgICAgICAgICByZXBvcnRJZDogXCI9P1wiLFxyXG5cdCAgICAgICAgICAgIG5hbWU6IFwiPT9cIixcclxuXHQgICAgICAgICAgICBvcHRpb25zOiBcIj0/XCJcclxuXHQgICAgICAgIH07XHJcblx0ICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBDb250cm9sbGVyO1xyXG5cdCAgICAgICAgdGhpcy5iaW5kVG9Db250cm9sbGVyID0gdHJ1ZTtcclxuXHQgICAgICAgIHRoaXMuY29udHJvbGxlckFzID0gXCJ2bVwiO1xyXG5cdCAgICB9XHJcblx0ICAgIERpcmVjdGl2ZS5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uICgkc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMsIGNvbnRyb2xsZXIsIHRyYW5zY2x1ZGVGbikge1xyXG5cdCAgICAgICAgY29udHJvbGxlci5pbml0KGVsZW1lbnRbMF0pO1xyXG5cdCAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgY29udHJvbGxlci5yZXNldChlbGVtZW50WzBdKTtcclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gRGlyZWN0aXZlO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IERpcmVjdGl2ZTtcclxuXG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgQ29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIENvbnRyb2xsZXIoJHNjb3BlLCBwb3dlckJpU2VydmljZSkge1xyXG5cdCAgICAgICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XHJcblx0ICAgICAgICB0aGlzLnBvd2VyQmlTZXJ2aWNlID0gcG93ZXJCaVNlcnZpY2U7XHJcblx0ICAgICAgICB0aGlzLnZhbGlkYXRpb25NYXAgPSB7XHJcblx0ICAgICAgICAgICAgJ3JlcG9ydCc6IHRoaXMudmFsaWRhdGVSZXBvcnRPcHRpb25zXHJcblx0ICAgICAgICB9O1xyXG5cdCAgICB9XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBIYW5kbGVyIGFmdGVyIGNvbXBvbmVudCBpcyBpbnNlcnRlZCBpbiB0aGUgRE9NLiBJZiByZXF1aXJlZCBhdHRyaWJ1dGVzIGFyZSB2YWxpZCBlbWJlZCBpbW1lZGlhdGVseVxyXG5cdCAgICAgKiBvdGhlcndpc2UsIHdhdGNoIGF0dHJpYnV0ZXMgYW5kIGVtYmVkIHdoZW4gdGhleSBhcmUgdmFsaWQuXHJcblx0ICAgICAqL1xyXG5cdCAgICBDb250cm9sbGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBpZiAodGhpcy52YWxpZGF0ZU9wdGlvbnModGhpcy5vcHRpb25zKSkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuZW1iZWQoZWxlbWVudCwgdGhpcy5vcHRpb25zKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHRoaXMuJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5vcHRpb25zOyB9LCBmdW5jdGlvbiAob3B0aW9ucywgb2xkT3B0aW9ucykge1xyXG5cdCAgICAgICAgICAgIC8vIEd1YXJkIGFnYWluc3QgaW5pdGlhbGl6YXRpb25cclxuXHQgICAgICAgICAgICBpZiAob3B0aW9ucyA9PT0gb2xkT3B0aW9ucykge1xyXG5cdCAgICAgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGlmIChfdGhpcy52YWxpZGF0ZU9wdGlvbnMoX3RoaXMub3B0aW9ucykpIHtcclxuXHQgICAgICAgICAgICAgICAgX3RoaXMuZW1iZWQoZWxlbWVudCwgX3RoaXMub3B0aW9ucyk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2UgaWYgKF90aGlzLmNvbXBvbmVudCkge1xyXG5cdCAgICAgICAgICAgICAgICBfdGhpcy5yZXNldChlbGVtZW50KTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9LCB0cnVlKTtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEdpdmVuIGFuIEhUTUxFbGVtZW50LCBjb25zdHJ1Y3QgYW4gZW1iZWQgY29uZmlndXJhdGlvbiBiYXNlZCBvbiBhdHRyaWJ1dGVzIGFuZCBwYXNzIHRvIHNlcnZpY2UuXHJcblx0ICAgICAqL1xyXG5cdCAgICBDb250cm9sbGVyLnByb3RvdHlwZS5lbWJlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XHJcblx0ICAgICAgICB0aGlzLmNvbXBvbmVudCA9IHRoaXMucG93ZXJCaVNlcnZpY2UuZW1iZWQoZWxlbWVudCwgb3B0aW9ucyk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBIYW5kbGVyIHdoZW4gY29tcG9uZW50IGlzIHJlbW92ZWQgZnJvbSBET00uIEZvcndhcmRzIGNhbGwgdG8gc2VydmljZSB0byBwZXJmb3JtIGNsZWFudXAgb2YgcmVmZXJlbmNlcyBiZWZvcmUgRE9NIGlzIG1vZGlmaWVkLlxyXG5cdCAgICAgKi9cclxuXHQgICAgQ29udHJvbGxlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cdCAgICAgICAgdGhpcy5wb3dlckJpU2VydmljZS5yZXNldChlbGVtZW50KTtcclxuXHQgICAgICAgIHRoaXMuY29tcG9uZW50ID0gbnVsbDtcclxuXHQgICAgfTtcclxuXHQgICAgLyoqXHJcblx0ICAgICAqIEVuc3VyZSByZXF1aXJlZCBvcHRpb25zIChlbWJlZFVybCBhbmQgYWNjZXNzVG9rZW4gYXJlIHZhbGlkIGJlZm9yZSBhdHRlbXB0aW5nIHRvIGVtYmVkKVxyXG5cdCAgICAgKi9cclxuXHQgICAgQ29udHJvbGxlci5wcm90b3R5cGUudmFsaWRhdGVPcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuXHQgICAgICAgIGlmICghdGhpcy5vcHRpb25zXHJcblx0ICAgICAgICAgICAgfHwgISh0eXBlb2Ygb3B0aW9ucy5lbWJlZFVybCA9PT0gJ3N0cmluZycgJiYgb3B0aW9ucy5lbWJlZFVybC5sZW5ndGggPiAwKVxyXG5cdCAgICAgICAgICAgIHx8ICEodHlwZW9mIG9wdGlvbnMuYWNjZXNzVG9rZW4gPT09ICdzdHJpbmcnICYmIG9wdGlvbnMuYWNjZXNzVG9rZW4ubGVuZ3RoID4gMCkpIHtcclxuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBpZiAodGhpcy52YWxpZGF0aW9uTWFwLmhhc093blByb3BlcnR5KG9wdGlvbnMudHlwZSkgJiYgdHlwZW9mIHRoaXMudmFsaWRhdGlvbk1hcFtvcHRpb25zLnR5cGVdID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy52YWxpZGF0aW9uTWFwW29wdGlvbnMudHlwZV0ob3B0aW9ucyk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIENvbnRyb2xsZXIucHJvdG90eXBlLnZhbGlkYXRlUmVwb3J0T3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHQgICAgfTtcclxuXHQgICAgQ29udHJvbGxlci4kaW5qZWN0ID0gW1xyXG5cdCAgICAgICAgJyRzY29wZScsXHJcblx0ICAgICAgICAnUG93ZXJCaVNlcnZpY2UnXHJcblx0ICAgIF07XHJcblx0ICAgIHJldHVybiBDb250cm9sbGVyO1xyXG5cdH0oKSk7XHJcblx0ZXhwb3J0cy5Db250cm9sbGVyID0gQ29udHJvbGxlcjtcclxuXHR2YXIgRGlyZWN0aXZlID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gRGlyZWN0aXZlKCkge1xyXG5cdCAgICAgICAgLy8gc3RhdGljIG5hbWUgPSBcInBvd2VyYmlDb21wb25lbnRcIjtcclxuXHQgICAgICAgIHRoaXMucmVzdHJpY3QgPSBcIkVcIjtcclxuXHQgICAgICAgIHRoaXMucmVwbGFjZSA9IHRydWU7XHJcblx0ICAgICAgICB0aGlzLnRlbXBsYXRlID0gJzxkaXYgY2xhc3M9XCJwb3dlcmJpLWZyYW1lXCI+PC9kaXY+JztcclxuXHQgICAgICAgIHRoaXMuc2NvcGUgPSB7XHJcblx0ICAgICAgICAgICAgYWNjZXNzVG9rZW46IFwiPVwiLFxyXG5cdCAgICAgICAgICAgIGVtYmVkVXJsOiBcIj1cIixcclxuXHQgICAgICAgICAgICBvcHRpb25zOiBcIj0/XCJcclxuXHQgICAgICAgIH07XHJcblx0ICAgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBDb250cm9sbGVyO1xyXG5cdCAgICAgICAgdGhpcy5iaW5kVG9Db250cm9sbGVyID0gdHJ1ZTtcclxuXHQgICAgICAgIHRoaXMuY29udHJvbGxlckFzID0gXCJ2bVwiO1xyXG5cdCAgICB9XHJcblx0ICAgIERpcmVjdGl2ZS5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uICgkc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMsIGNvbnRyb2xsZXIsIHRyYW5zY2x1ZGVGbikge1xyXG5cdCAgICAgICAgY29udHJvbGxlci5pbml0KGVsZW1lbnRbMF0pO1xyXG5cdCAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgY29udHJvbGxlci5yZXNldChlbGVtZW50WzBdKTtcclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gRGlyZWN0aXZlO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IERpcmVjdGl2ZTtcclxuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgcGJpID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcclxuXHR2YXIgUG93ZXJCaVNlcnZpY2UgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBQb3dlckJpU2VydmljZShQb3dlckJpKSB7XHJcblx0ICAgICAgICB0aGlzLnBvd2VyQmlDb3JlU2VydmljZSA9IG5ldyBQb3dlckJpKHBiaS5mYWN0b3JpZXMuaHBtRmFjdG9yeSwgcGJpLmZhY3Rvcmllcy53cG1wRmFjdG9yeSwgcGJpLmZhY3Rvcmllcy5yb3V0ZXJGYWN0b3J5KTtcclxuXHQgICAgfVxyXG5cdCAgICBQb3dlckJpU2VydmljZS5wcm90b3R5cGUuZW1iZWQgPSBmdW5jdGlvbiAoZWxlbWVudCwgY29uZmlnKSB7XHJcblx0ICAgICAgICByZXR1cm4gdGhpcy5wb3dlckJpQ29yZVNlcnZpY2UuZW1iZWQoZWxlbWVudCwgY29uZmlnKTtcclxuXHQgICAgfTtcclxuXHQgICAgUG93ZXJCaVNlcnZpY2UucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuXHQgICAgICAgIHRoaXMucG93ZXJCaUNvcmVTZXJ2aWNlLnJlc2V0KGVsZW1lbnQpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBQb3dlckJpU2VydmljZS4kaW5qZWN0ID0gW1xyXG5cdCAgICAgICAgJ1Bvd2VyQmlHbG9iYWwnXHJcblx0ICAgIF07XHJcblx0ICAgIHJldHVybiBQb3dlckJpU2VydmljZTtcclxuXHR9KCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBQb3dlckJpU2VydmljZTtcclxuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNF9fO1xuXG4vKioqLyB9XG4vKioqKioqLyBdKVxufSk7XG47XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmd1bGFyLXBvd2VyYmkuanMubWFwIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
